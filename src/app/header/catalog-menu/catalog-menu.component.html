<ul class="menu">
  <ng-container *ngFor="let category of categories">
    <ng-container *ngTemplateOutlet="categoryTmpl; context: { category: category }"></ng-container>
  </ng-container>
</ul>

<ng-template let-category="category" #categoryTmpl>
  <li class="menu__item">
    <div class="menu__link-container">
      <a class="menu__link" [routerLink]="['/', category.slug]">
        {{ category.name }}
      </a>

      <ng-container *ngIf="category.children.length">
        <i class="mbi mbi-ios-arrow-right menu__hover-arrow"></i>

        <span class="menu__expand-arrow"
              [class.menu__arrow--expanded]="category.isExpanded"
              (click)="category.isExpanded = !category.isExpanded"
        >
          <i class="mbi mbi-chevron-down" [class.menu__expand-icon--active]="category.isExpanded"></i>
        </span>
      </ng-container>
    </div>

    <ul class="menu__submenu" *ngIf="category.children.length" [class.menu__submenu--expanded]="category.isExpanded">
      <ng-container *ngFor="let subCategory of category.children">
        <ng-container *ngTemplateOutlet="categoryTmpl; context: { category: subCategory }"></ng-container>
      </ng-container>
    </ul>
  </li>
</ng-template>
